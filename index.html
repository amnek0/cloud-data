<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <head>
    <title>Cloud Data</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap-->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
	<div class="container">
		<h1>Cloud investigation</h1>
		<p>The below summarizes a rough investigation of cloud usage across a series of datasets from the <a href="http://www.crunchbase.com/company/techcrunch">TechCrunch CrunchBase API</a> and from the 2000 most popular sites, as measured by US traffic, by <a href="http://www.alexa.com/topsites/countries/US">Alexa</a>.</p>
		<p>The TechCrunch CrunchBase API was used to gather all domains for all startups from 2006 through present (Jan, 2014). Startups that were unfunded, "deadpooled" (no longer in operation), did not list a web address, or had a web address that was not registered were removed from the dataset. This data was sliced by year.</p>
		<p>The Alexa data was gathered from <a href="http://aws.amazon.com/awis/">Amazon's Alexa Web Information Service</a> and represents the 2000 most popular sites based on US traffic (as measured on December 22, 2013).</p>
		<p>Five of the most popular cloud hosts, Google, Microsoft, Softlayer, Rackspace, and Amazon, were tracked across these domains.</p>
		<p>For each domain name, the IP address was retrieved. From this IP address, the organization was retrieved from <a href="http://arin.net">ARIN</a>. If this organization was in our list of five cloud hosts, the count for the cloud host was incremented. If the organization was not mapped to one of the five cloud hosts it was counted as "Other."</p>
	      <h2 id="details">Summary of CrunchBase and Alexa datasets</h2>
			<table class="table-striped table-hover" id="agg">
		    	<thead>
				<tr>
					<th>Data Set</th>
					<th>Total</th>
					<th>Amazon</th>
					<th>Rackspace</th>
					<th>Softlayer</th>
					<th>Microsoft</th>
					<th>Google</th>
					<th>Other</th>
				</tr>
				</thead>
				<tr>
					<td><a href="data/downloads/crunchbase_2006.csv">CrunchBase 2006</a></td>
					<td>2467</td>
					<td>357 or 14.47%</td>
					<td>40 or 1.62%</td>
					<td>66 or 2.68%</td>
					<td>21 or 0.85%</td>
					<td>15 or 0.61%</td>
					<td>1968 or 79.77%</td>
				</tr>
				<tr>
					<td><a href="data/downloads/crunchbase_2007.csv">CrunchBase 2007</a></td>
					<td>3493</td>
					<td>564 or 16.15%</td>
					<td>82 or 2.35%</td>
					<td>84 or 2.40%</td>
					<td>19 or 0.54%</td>
					<td>29 or 0.83%</td>
					<td>2715 or 77.73%</td>
				</tr>
				<tr>
					<td><a href="data/downloads/crunchbase_2008.csv">CrunchBase 2008</a></td>
					<td>4435</td>
					<td>679 or 15.31%</td>
					<td>113 or 2.55%</td>
					<td>99 or 2.23%</td>
					<td>25 or 0.56%</td>
					<td>40 or 0.90%</td>
					<td>3479 or 78.44%</td>
				</tr>
				<tr>
					<td><a href="data/downloads/crunchbase_2009.csv">CrunchBase 2009</a></td>
					<td>6907</td>
					<td>1822 or 26.38%</td>
					<td>89 or 1.29%</td>
					<td>138 or 2.00%</td>
					<td>112 or 1.62%</td>
					<td>133 or 1.93%</td>
					<td>4613 or 66.79%</td>
				</tr>
				<tr>
					<td><a href="data/downloads/crunchbase_2010.csv">CrunchBase 2010</a></td>
					<td>6160</td>
					<td>1310 or 21.27%</td>
					<td>147 or 2.39%</td>
					<td>125 or 2.03%</td>
					<td>67 or 1.09%</td>
					<td>82 or 1.33%</td>
					<td>4429 or 71.90%</td>
				</tr>
				<tr>
					<td><a href="data/downloads/crunchbase_2011.csv">CrunchBase 2011</a></td>
					<td>6905</td>
					<td>1806 or 26.15%</td>
					<td>89 or 1.29%</td>
					<td>140 or 2.03%</td>
					<td>112 or 1.62%</td>
					<td>129 or 1.87%</td>
					<td>4629 or 67.04%</td>
				</tr>
				<tr>
					<td><a href="data/downloads/crunchbase_2012.csv">CrunchBase 2012</a></td>
					<td>6742</td>
					<td>1844 or 27.35%</td>
					<td>90 or 1.33%</td>
					<td>141 or 2.09%</td>
					<td>139 or 2.06%</td>
					<td>138 or 2.05%</td>
					<td>4390 or 65.11%</td>
				</tr>
				<tr>
					<td><a href="data/downloads/crunchbase_2010_2013.csv">CrunchBase 2013</a></td>
					<td>4086</td>
					<td>1052 or 25.75%</td>
					<td>28 or 0.69%</td>
					<td>83 or 2.03%</td>
					<td>96 or 2.35%</td>
					<td>64 or 1.57%</td>
					<td>2763 or 67.62%</td>
				</tr>
				<tr>
					<td><a href="data/downloads/top_2000.csv">Alexa Top 2000</a></td>
					<td>1469</td>
					<td>179 or 12.19%</td>
					<td>5 or 0.34%</td>
					<td>58 or 3.95%</td>
					<td>11 or 0.75%</td>
					<td>24 or 1.63%</td>
					<td>1192 or 81.14%</td>
				</tr>
			</table> <!-- / agg table -->
			<h2>CrunchBase data, graphed</h2>
			<div id="graph_container">
			<script src="js/d3.v3.min.js"></script>
			<script>

			var margin = {top: 20, right: 20, bottom: 30, left: 40},
			    width = 960 - margin.left - margin.right,
			    height = 500 - margin.top - margin.bottom;

			var x0 = d3.scale.ordinal()
			    .rangeRoundBands([0, width], .1);

			var x1 = d3.scale.ordinal();

			var y = d3.scale.linear()
			    .range([height, 0]);

			var color = d3.scale.ordinal()
			    .range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"]);

			var xAxis = d3.svg.axis()
			    .scale(x0)
			    .orient("bottom");

			var yAxis = d3.svg.axis()
			    .scale(y)
			    .orient("left")
			    .tickFormat(d3.format(".2s"));

			var svg = d3.select("#graph_container").append("svg")
			    .attr("width", width + margin.left + margin.right)
			    .attr("height", height + margin.top + margin.bottom)
			  .append("g")
			    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

			d3.csv("data.csv", function(error, data) {
			  var ageNames = d3.keys(data[0]).filter(function(key) { return key !== "ds"; });

			  data.forEach(function(d) {
			    d.ages = ageNames.map(function(name) { return {name: name, value: +d[name]}; });
			  });

			  x0.domain(data.map(function(d) { return d.ds; }));
			  x1.domain(ageNames).rangeRoundBands([0, x0.rangeBand()]);
			  y.domain([0, d3.max(data, function(d) { return d3.max(d.ages, function(d) { return d.value; }); })]);

			  svg.append("g")
			      .attr("class", "x axis")
			      .attr("transform", "translate(0," + height + ")")
			      .call(xAxis);

			  svg.append("g")
			      .attr("class", "y axis")
			      .call(yAxis)
			    .append("text")
			      .attr("transform", "rotate(-90)")
			      .attr("y", 6)
			      .attr("dy", ".71em")
			      .style("text-anchor", "end")
			      .text("Percent");

			  var ds = svg.selectAll(".ds")
			      .data(data)
			    .enter().append("g")
			      .attr("class", "g")
			      .attr("transform", function(d) { return "translate(" + x0(d.ds) + ",0)"; });

			  ds.selectAll("rect")
			      .data(function(d) { return d.ages; })
			    .enter().append("rect")
			      .attr("width", x1.rangeBand())
			      .attr("x", function(d) { return x1(d.name); })
			      .attr("y", function(d) { return y(d.value); })
			      .attr("height", function(d) { return height - y(d.value); })
			      .style("fill", function(d) { return color(d.name); });

			  var legend = svg.selectAll(".legend")
			      .data(ageNames.slice().reverse())
			    .enter().append("g")
			      .attr("class", "legend")
			      .attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });

			  legend.append("rect")
			      .attr("x", width - 18)
			      .attr("width", 18)
			      .attr("height", 18)
			      .style("fill", color);

			  legend.append("text")
			      .attr("x", width - 24)
			      .attr("y", 9)
			      .attr("dy", ".35em")
			      .style("text-anchor", "end")
			      .text(function(d) { return d; });

			});

			</script>
			</div>

			<h2>Known issues</h2>
			<p>The above is a rough first pass at data gathering. There were a number of corner cases that were ignored during the harvest.</p>
			<ul>
				<li>Addresses not managed by ARIN are not mapped and not included in the totals</li>
				<li>ARIN does not display some organizations publicly and not included in the totals</li>
				<li>If a zone is managed by third party (Akamai or CloudFlare might be common), they might be acting as proxy</li>
				<li>Many places use round-robin DNS (different IPs managed by different orgs)</li>
			</ul>
	</div> <!-- /container -->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.tablesorter.min.js"></script>
	<script type="text/javascript">
		$(document).ready(function() { 
			console.log('loaded')
		        $("table").tablesorter(); 
		    } 
		);
	</script>

  </body>
</html>
